% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/palaeorotate.R
\name{palaeorotate}
\alias{palaeorotate}
\title{Palaeorotate fossil occurrences}
\usage{
palaeorotate(
  occdf,
  lng = "lng",
  lat = "lat",
  age = "age",
  model = "MERDITH2021",
  method = "grid",
  uncertainty = FALSE
)
}
\arguments{
\item{occdf}{\code{dataframe}. Fossil occurrences to be palaeogeographically
reconstructed. \code{occdf} should contain columns with longitudinal and
latitudinal values, as well as age estimates. The age of rotation should be
supplied in millions of years before present.}

\item{lng}{\code{character}. The name of the column you wish to be treated as
longitude (defaults to "lng").}

\item{lat}{\code{character}. The name of the column you wish to be treated as
latitude (defaults to "lat").}

\item{age}{\code{numeric}. The name of the column you wish to be treated as
the age for rotation (defaults to "age").}

\item{model}{\code{character}. The name of the plate rotation model to be
used to reconstruct palaeocoordinates. See details for available models
(\code{method} specific).}

\item{method}{\code{character}. Method used to calculate palaeocoordinates
for fossil occurrences. Either "grid" to use rotation files, or "point"
to use the GPlates API service.}

\item{uncertainty}{\code{logical}. Should the uncertainty in
palaeogeographic reconstructions be returned? If set to TRUE, the
palaeocoordinates from the three available rotation files are returned
("MERDITH2021", "PALEOMAP", and "WRIGHT2013"), along with their
respective longitudinal and latitudinal range. This argument is only
relevant if \code{method} is set to "grid".}
}
\value{
A \code{dataframe} containing the original input occurrence
dataframe, age of rotation ("rot_age"), the reference coordinates rotated
("rot_lng" and "rot_lat"), and the reconstructed coordinates
(i.e., "p_lng" and "p_lat"). The "point" \code{method} uses the input coordinates
and age as the reference; reference coordinates are therefore not returned.
}
\description{
A function to generate palaeocoordinates for fossil occurrence data
(i.e., reconstruct the geographic distribution of organisms'
remains at time of deposition). Each occurrence is assigned
palaeocoordinates based on its current geographic position and age
estimate.
}
\details{
This function can generate palaeocoordinates using two different
approaches (\code{method}):
\itemize{
\item Rotation files: The "grid" \code{method} uses rotation files to spatiotemporally
link present-day geographic coordinates and age estimates with a spatial
grid (1° x 1°) rotated to the midpoint of stratigraphic stages
(Geological Timescale, 2020). If specific ages of rotation are required,
or fine-scale spatial analyses are being conducted, use of the "point"
\code{method} might be preferable for the user (particularly if occurrences are
close to plate boundaries). As implemented, points within the same grid cell
will be assigned equivalent palaeocoordinates due to spatial aggregation. The
current palaeorotations (0--540 Ma) provided were generated using a
1° x 1° spatial grid with the GPlates software
\url{https://www.gplates.org} and three plate rotation models
(Wright et al. 2013; Scotese & Wright, 2018; Merdith et al., 2021).
\item GPlates API: The "point" \code{method} uses the GPlates API service
\url{https://gwsdoc.gplates.org} to reconstruct palaeorotations for point
data. The use of this \code{method} is slower than the "grid" \code{method} if many
unique time intervals exist in your dataset. However, it provides
palaeocoordinates with higher precision.
}

Available models for each method:
\itemize{
\item "MERDITH2021" (grid & point)
\item "PALEOMAP" (grid & point)
\item "MULLER2019" (point)
\item "MATTHEWS2016" (point)
\item "WRIGHT2013" (grid)
\item "RODINIA2013" (point)
\item "SETON2012" (point)
\item "GOLONKA" (point)
}
}
\section{References}{

\itemize{
\item Merdith, A., Williams, S.E., Collins, A.S., Tetley, M.G., Mulder, J.A.,
Blades, M.L., Young, A., Armistead, S.E., Cannon, J., Zahirovic, S.,
Müller. R.D. (2021).
Extending full-plate tectonic models into deep time: Linking the
Neoproterozoic and the Phanerozoic.
Earth-Science Reviews 214 (103477). \doi{10.1016/j.earscirev.2020.103477}.
\item Müller, R. D., Zahirovic, S., Williams, S. E., Cannon, J., Seton, M.,
Bower, D. J., Tetley, M. G., Heine, C., Le Breton, E., Liu, S.,
Russell, S. H. J., Yang, T., Leonard, J., and Gurnis, M. (2019).
A global plate model including lithospheric deformation along major rifts
and orogens since the Triassic.
Tectonics, vol. 38. \doi{10.1029/2018TC005462}.
\item Scotese, C., & Wright, N. M. (2018). PALEOMAP Paleodigital Elevation Models
(PaleoDEMs) for the
Phanerozoic. PALEOMAP Project.
\url{https://www.earthbyte.org/paleodem-resource-scotese-and-wright-2018/}.
\item Matthews, K.J., Maloney, K.T., Zahirovic, S., Williams, S.E., Seton, M.,
and Müller, R.D. (2016). Global plate boundary evolution and kinematics
since the late Paleozoic, Global and Planetary Change, 146, 226-250.
\doi{10.1016/j.gloplacha.2016.10.002}.
\item Wright, N., Zahirovic, S., Müller, R. D., & Seton, M. (2013). Towards
community-driven paleogeographic
reconstructions: integrating open-access paleogeographic and paleobiology
data with plate tectonics.
Biogeosciences, 10(3), 1529–1541. \doi{10.5194/bg-10-1529-2013}.
\item Seton, M., Müller, R.D., Zahirovic, S., Gaina, C., Torsvik, T.H.,
Shephard, G., Talsma, A., Gurnis, M., Turner, M., Maus, S., Chandler, M.
(2012). Global continental and ocean basin reconstructions since 200 Ma.
Earth-Science Reviews, Volume 113, Issues 3-4, July 2012, Pages 212--270.
\doi{10.1016/j.earscirev.2012.03.002}.
}

See GPlates documentation for additional information:
\url{https://gwsdoc.gplates.org/reconstruction}.
}

\section{Developer(s)}{

Lewis A. Jones
}

\section{Reviewer(s)}{

Kilian Eichenseer and Lucas Buffan
}

\examples{
#Generic example with a few occurrences
occdf <- data.frame(lng = c(2, -103, -66),
                lat = c(46, 35, -7),
                age = c(88, 125, 200))

#Calculate palaeocoordinates using rotation files
palaeorotate(occdf = occdf, method = "grid")

#Calculate palaeocoordinates using the GPlates API
palaeorotate(occdf = occdf, method = "point")

#Now with some real fossil occurrence data!

#Grab some data from the Paleobiology Database
data(tetrapods)

#Assign midpoint age of fossil occurrence data for rotation
tetrapods$age <- (tetrapods$max_ma + tetrapods$min_ma)/2

#Rotate the data
palaeorotate(occdf = tetrapods)

#Calculate uncertainity in palaeocoordinates from models
palaeorotate(occdf = tetrapods, uncertainty = TRUE)
}
