<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A function to plot the stratigraphic ranges of fossil taxa from occurrence
data."><title>Generate a stratigraphic section plot — tax_range_strat • palaeoverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate a stratigraphic section plot — tax_range_strat"><meta property="og:description" content="A function to plot the stratigraphic ranges of fossil taxa from occurrence
data."><meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a>
    <a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a>
    <a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate a stratigraphic section plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/HEAD/R/tax_range_strat.R" class="external-link"><code>R/tax_range_strat.R</code></a></small>
      <div class="d-none name"><code>tax_range_strat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to plot the stratigraphic ranges of fossil taxa from occurrence
data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tax_range_strat</span><span class="op">(</span></span>
<span>  <span class="va">occdf</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"genus"</span>,</span>
<span>  level <span class="op">=</span> <span class="st">"bed"</span>,</span>
<span>  certainty <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"FAD"</span>,</span>
<span>  plot_args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_args <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>occdf</dt>
<dd><p><code>dataframe</code>. A dataframe of fossil occurrences containing
at least two columns: names of taxa, and their stratigraphic position (see
<code>name</code> and <code>level</code> arguments).</p></dd>


<dt>name</dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as the input names, e.g. "genus" (default).</p></dd>


<dt>level</dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as the stratigraphic levels associated with each occurrence, e.g. "bed"
(default) or "height". Stratigraphic levels must be <code>numeric</code>.</p></dd>


<dt>certainty</dt>
<dd><p><code>character</code>. The name of the column you wish to be
treated as the information on whether an identification is certain (1) or
uncertain (0). By default (<code>certainty = NULL</code>), no column name is
provided, and all occurrences are assumed to be certain. In the plot,
certain occurrences will be plotted with a black circle and joined with
solid lines, while uncertain occurrences will be plotted with a white
circle and joined with dashed lines.</p></dd>


<dt>by</dt>
<dd><p><code>character</code>. How should the output be sorted? Either: "FAD"
(first appearance; default), "LAD" (last appearance), or "name"
(alphabetically by taxon names).</p></dd>


<dt>plot_args</dt>
<dd><p>A list of optional arguments that are passed directly to
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">graphics::plot()</a></code>. Subsets of these arguments are also passed to
<code><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">graphics::segments()</a></code> and <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">graphics::points()</a></code> (see Details). Useful
arguments include <code>xlab</code> (the x-axis label), <code>ylab</code> (the y-axis label,
default is "Bed number"), <code>main</code> (the plot title), <code>xlim</code> (the x-axis
limits), and <code>ylim</code> (the y-axis limits). The <code>axes</code> and <code>type</code> arguments
are not supported and will be overridden.</p></dd>


<dt>x_args</dt>
<dd><p>A list of optional arguments that are passed directly to
<code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis()</a></code> when generating the x-axis. Useful arguments include <code>font</code> (e.g.,
<code>3</code> is italic) and <code>las</code> (label orientation). The <code>side</code> argument is not
supported and will be overridden. If the <code>at</code> and <code>labels</code> arguments are
not specified, the x-axis tick labels will be set to the taxon names.</p></dd>


<dt>y_args</dt>
<dd><p>A list of optional arguments that are passed directly to
<code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis()</a></code> when generating the y-axis. Useful arguments include <code>font</code> (e.g.,
<code>3</code> is italic) and <code>las</code> (label orientation). The <code>side</code> argument is not
supported and will be overridden. If the <code>at</code> argument is not specified, it
will be set to a vector of the unique values from the <code>level</code> column.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Invisibly returns a data.frame of the calculated taxonomic
stratigraphic ranges.</p>


<p>The function is usually used for its side effect, which is to create a plot
showing the stratigraphic ranges of taxa in a section, with levels at which
the taxon was sampled indicated with a point.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that the default spacing for the x-axis title may cause it to
overlap with the x-axis tick labels. To avoid this, you can call
<code><a href="https://rdrr.io/r/graphics/title.html" class="external-link">graphics::title()</a></code> after running <code>tax_range_strat()</code> and specify both
<code>xlab</code> and <code>line</code> to add the x-axis title farther from the axis (see
examples).</p>
<p>The styling of the points and line segments can be adjusted by supplying
named arguments to <code>plot_args</code>. <code>col</code> (segment and point color), <code>lwd</code>
(segment width), <code>pch</code> (point symbol), <code>bg</code> (background point color for
some values of <code>pch</code>), <code>lty</code> (segment line type), and <code>cex</code> (point size)
are supported. In the case of a column being supplied to the <code>certainty</code>
argument, these arguments may be vectors of length two, in which case the
first value of the vector will be used for the "certain" points and
segments, and the second value of the vector will be used for the
"uncertain" points and segments. If only a single value is supplied, it
will be used for both. The default values for these arguments are as
follows:</p><ul><li><p><code>col</code> = <code>c("black", "black")</code></p></li>
<li><p><code>lwd</code> = <code>c(1.5, 1.5)</code></p></li>
<li><p><code>pch</code> = <code>c(19, 21)</code></p></li>
<li><p><code>bg</code> = <code>c("black", "white")</code></p></li>
<li><p><code>lty</code> = <code>c(1, 2)</code></p></li>
<li><p><code>cex</code> = <code>c(1, 1)</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="developer-s-">Developer(s)<a class="anchor" aria-label="anchor" href="#developer-s-"></a></h2>
    <p>Bethany Allen, William Gearty &amp; Alexander Dunhill</p>
    </div>
    <div class="section level2">
    <h2 id="reviewer-s-">Reviewer(s)<a class="anchor" aria-label="anchor" href="#reviewer-s-"></a></h2>
    <p>William Gearty &amp; Lewis A. Jones</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load tetrapod dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tetrapods</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Sample tetrapod occurrences</span></span></span>
<span class="r-in"><span><span class="va">tetrapod_names</span> <span class="op">&lt;-</span> <span class="va">tetrapods</span><span class="op">$</span><span class="va">accepted_name</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Simulate bed numbers</span></span></span>
<span class="r-in"><span><span class="va">beds_sampled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, size <span class="op">=</span> <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Simulate certainty values</span></span></span>
<span class="r-in"><span><span class="va">certainty_sampled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Combine into data frame</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon <span class="op">=</span> <span class="va">tetrapod_names</span>,</span></span>
<span class="r-in"><span>                    bed <span class="op">=</span> <span class="va">beds_sampled</span>,</span></span>
<span class="r-in"><span>                    certainty <span class="op">=</span> <span class="va">certainty_sampled</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot stratigraphic ranges</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tax_range_strat</span><span class="op">(</span><span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tax_range_strat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">tax_range_strat</span><span class="op">(</span><span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"taxon"</span>, certainty <span class="op">=</span> <span class="st">"certainty"</span>,</span></span>
<span class="r-in"><span>                plot_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylab <span class="op">=</span> <span class="st">"Stratigraphic height (m)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tax_range_strat-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot stratigraphic ranges with more labelling</span></span></span>
<span class="r-in"><span><span class="fu">tax_range_strat</span><span class="op">(</span><span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"taxon"</span>, certainty <span class="op">=</span> <span class="st">"certainty"</span>, by <span class="op">=</span> <span class="st">"name"</span>,</span></span>
<span class="r-in"><span>                plot_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Section A"</span>,</span></span>
<span class="r-in"><span>                                 ylab <span class="op">=</span> <span class="st">"Stratigraphic height (m)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eras_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mesozoic"</span>, <span class="st">"Cenozoic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          max_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          min_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">10.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#67C5CA"</span>, <span class="st">"#F2F91D"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="axis_geo.html">axis_geo</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">4</span>, intervals <span class="op">=</span> <span class="va">eras_custom</span>, tick_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>xlab <span class="op">=</span> <span class="st">"Taxon"</span>, line <span class="op">=</span> <span class="fl">10.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tax_range_strat-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

