<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A function to assign fossil occurrences to specified time bins based on
different approaches commonly applied in palaeobiology."><title>Assign fossil occurrences to time bins — bin_time • palaeoverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assign fossil occurrences to time bins — bin_time"><meta property="og:description" content="A function to assign fossil occurrences to specified time bins based on
different approaches commonly applied in palaeobiology."><meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a>
    <a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a>
    <a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Assign fossil occurrences to time bins</h1>
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/HEAD/R/bin_time.R" class="external-link"><code>R/bin_time.R</code></a></small>
      <div class="d-none name"><code>bin_time.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to assign fossil occurrences to specified time bins based on
different approaches commonly applied in palaeobiology.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bin_time</span><span class="op">(</span></span>
<span>  <span class="va">occdf</span>,</span>
<span>  min_ma <span class="op">=</span> <span class="st">"min_ma"</span>,</span>
<span>  max_ma <span class="op">=</span> <span class="st">"max_ma"</span>,</span>
<span>  <span class="va">bins</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mid"</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  fun <span class="op">=</span> <span class="va">dunif</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>occdf</dt>
<dd><p><code>dataframe</code>. A dataframe of the fossil occurrences you
wish to bin. This dataframe should contain at least two columns with
<code>numeric</code> values: maximum age of occurrence and minimum age of
occurrence (see <code>max_ma</code>, <code>min_ma</code>). If required, <code>numeric</code> ages can be
generated from interval names via the
<code><a href="look_up.html">look_up()</a></code> function.</p></dd>


<dt>min_ma</dt>
<dd><p><code>character</code>. The name of the column you wish to be
treated as the minimum age for <code>occdf</code> and <code>bins</code>, e.g. "min_ma"
(default).</p></dd>


<dt>max_ma</dt>
<dd><p><code>character</code>. The name of the column you wish to be
treated as the maximum age for <code>occdf</code> and <code>bins</code>, e.g. "max_ma"
(default).</p></dd>


<dt>bins</dt>
<dd><p><code>dataframe</code>. A dataframe of the bins that you wish to
allocate fossil occurrences to such as that returned by
<code><a href="time_bins.html">time_bins()</a></code>. This dataframe must
contain at least the following named columns: "bin" and those specified
to <code>max_ma</code> (default: "max_ma") and <code>min_ma</code> (default: "min_ma").
Columns <code>max_ma</code> and <code>min_ma</code> must be <code>numeric</code> values.</p></dd>


<dt>method</dt>
<dd><p><code>character</code>. The method desired for binning fossil
occurrences. Currently, five methods exist in this function: "mid",
"majority", "all", "random", and "point". See Details for a description
of each.</p></dd>


<dt>reps</dt>
<dd><p><code>numeric</code>. A non-negative <code>numeric</code> specifying the number
of replications for sampling. This argument is only useful in the case of
the "random" or "point" method being specified in the <code>method</code> argument.
Defaults to 100.</p></dd>


<dt>fun</dt>
<dd><p><code>function</code>. A probability density function from the
stats package such as <a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a> or <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a>.
This argument is only useful if the "point" method is specified in the
<code>method</code> argument.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments available in the called function (<code>fun</code>).
These arguments may be required for function arguments without default
values, or if you wish to overwrite the default argument value (see
example). <code>x</code> input values are generated internally based
on the age range of the fossil occurrence and should not be manually
provided. Note that <code>x</code> input values range between 0 and 1, and
function arguments should therefore be scaled to be within these bounds.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For methods "mid", "majority" and "all", a <code>dataframe</code> of the
original input <code>occdf</code> with the following appended columns is returned:
occurrence id (<code>id</code>), number of bins that the occurrence age range covers
(<code>n_bins</code>), bin assignment (<code>bin_assignment</code>), and bin midpoint
(<code>bin_midpoint</code>). In the case of the "majority" method, an additional
column of the majority percentage overlap (<code>overlap_percentage</code>) is also
appended. For the "random" and "point" method, a <code>list</code> is returned
(of length reps) with each element a copy of the <code>occdf</code> and appended
columns (random: <code>bin_assignment</code> and <code>bin_midpoint</code>; point:
<code>bin_assignment</code> and <code>point_estimates</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Five approaches (methods) exist in the <code>bin_time()</code> function for
assigning occurrences to time bins:</p><ul><li><p>Midpoint: The "mid" method is the simplest approach and uses the midpoint
of the fossil occurrence age range to bin the occurrence.</p></li>
<li><p>Majority: The "majority" method bins an occurrence into the bin which it
most overlaps with. As part of this implementation, the majority
percentage overlap of the occurrence is also calculated and returned as
an additional column in <code>occdf</code>. If desired, these percentages can be
used to further filter an occurrence dataset.</p></li>
<li><p>All: The "all" method bins an occurrence into every bin its age range
covers. For occurrences with age ranges of more than one bin, the
occurrence row is duplicated. Each occurrence is assigned an ID in the
column <code>occdf$id</code> so that duplicates can be tracked. Additionally,
<code>occdf$n_bins</code> records the number of bins each occurrence appears within.</p></li>
<li><p>Random: The "random" method randomly samples X amount of bins (with
replacement) from the bins that the fossil occurrence age range covers
with equal probability regardless of bin length. The <code>reps</code> argument
determines the number of times the sample process is repeated. All
replications are stored as individual elements within the returned list
with an appended <code>bin_assignment</code> and <code>bin_midpoint</code> column to the
original input <code>occdf</code>. If desired, users can easily bind this list using
<code>do.call(rbind, x)</code>.</p></li>
<li><p>Point: The "point" method randomly samples X (<code>reps</code>) amount of point age
estimates from the age range of the fossil occurrence. Sampling follows a
user-input probability density function such
as <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a> (see example 5). Users should also provide any
additional arguments for the probability density function (see <code>...</code>).
However, <code>x</code> (vector of quantiles) values should not be provided as these
values are input from the age range of each occurrence. These
values range between 0 and 1, and therefore function arguments should be
scaled to be within these bounds. The <code>reps</code> argument determines the
number of times the sample process is repeated. All replications are
stored as individual elements within the returned list with an appended
<code>bin_assignment</code> and <code>point_estimates</code> column to the original input
<code>occdf</code>. If desired, users can easily bind this list using
<code>do.call(rbind, x)</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="developer-s-">Developer(s)<a class="anchor" aria-label="anchor" href="#developer-s-"></a></h2>
    <p>Christopher D. Dean &amp; Lewis A. Jones</p>
    </div>
    <div class="section level2">
    <h2 id="reviewer-s-">Reviewer(s)<a class="anchor" aria-label="anchor" href="#reviewer-s-"></a></h2>
    <p>William Gearty</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Grab internal tetrapod data</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="va">tetrapods</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="time_bins.html">time_bins</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Assign via midpoint age of fossil occurrence data</span></span></span>
<span class="r-in"><span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu">bin_time</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"mid"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>One or more occurrences have a midpoint age equivalent to a bin boundary. Binning skipped for these occurrences. Hint: `which(is.na(occdf$bin_assignment))`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Assign to all bins that age range covers</span></span></span>
<span class="r-in"><span><span class="va">ex2</span> <span class="op">&lt;-</span> <span class="fu">bin_time</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Assign via majority overlap based on fossil occurrence age range</span></span></span>
<span class="r-in"><span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="fu">bin_time</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"majority"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Assign randomly to overlapping bins based on fossil occurrence age range</span></span></span>
<span class="r-in"><span><span class="va">ex4</span> <span class="op">&lt;-</span> <span class="fu">bin_time</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"random"</span>, reps <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Assign point estimates following a normal distribution</span></span></span>
<span class="r-in"><span><span class="va">ex5</span> <span class="op">&lt;-</span> <span class="fu">bin_time</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"point"</span>, reps <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                fun <span class="op">=</span> <span class="va">dnorm</span>, mean <span class="op">=</span> <span class="fl">0.5</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

